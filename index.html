<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en-US">
    <title>STAC Search Viewer</title>
    <link rel="stylesheet" href="./src/styles/main.css">
</head>
<body>
    <div id="app">
        <!-- Header Section / 头部区域 -->
        <header class="header">
            <h1>STAC Items Search Viewer</h1>
            <div class="header-subline">
                <p>Search and visualize STAC items</p>
                <div class="header-right">
                    <a class="author-link" href="https://github.com/Junhao2314" target="_blank" rel="noopener noreferrer" title="Liu Junhao on GitHub">
                    <svg class="gh-icon" viewBox="0 0 16 16" aria-hidden="true" focusable="false" fill="currentColor">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.28.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                    <span>by Liu Junhao</span>
                </a>
                    <button id="theme-toggle" class="theme-toggle-btn" type="button" title="Toggle dark/light theme" aria-label="Toggle dark/light theme">
                        <svg class="icon-sun" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="icon-moon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <span class="theme-label">Theme</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Container / 主容器 -->
        <div class="main-container">
            <!-- Left Panel - Search Controls / 左侧面板 - 搜索控件 -->
            <aside class="search-panel">
                <h2>Search Parameters</h2>
                
                <div class="form-group">
                    <label for="provider">Provider:</label>
                    <select id="provider" aria-describedby="provider-desc">
                        <option value="planetary-computer">Microsoft Planetary Computer</option>
                        <option value="earth-search">AWS Earth Search</option>
                        <option value="copernicus-dataspace">Copernicus Data Space</option>
                    </select>
                    <span id="provider-desc" class="visually-hidden">Select a STAC data provider</span>
                </div>

                <div class="form-group">
                    <label for="collection">Collection:</label>
                    <div class="collection-picker">
                        <input type="hidden" id="collection" value="">
                        <button id="open-collection-picker" class="secondary-btn" type="button" title="Select a collection">Select Collection</button>
                    </div>
                </div>

                <div class="form-group">
                    <label id="datetime-label">Date Range:</label>
                    <div class="date-range" role="group" aria-labelledby="datetime-label">
                        <label for="date-from" class="visually-hidden">Start date</label>
                        <div class="date-input-wrapper">
                            <input type="text" id="date-from-display" class="date-display" placeholder="YYYY-MM-DD" aria-label="Start date" inputmode="numeric">
                            <input type="date" id="date-from" class="date-native" lang="en-US" tabindex="-1" aria-hidden="true">
                            <button type="button" class="date-picker-btn" aria-label="Open date picker" tabindex="-1">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </button>
                        </div>
                        <span class="date-separator" aria-hidden="true">–</span>
                        <label for="date-to" class="visually-hidden">End date</label>
                        <div class="date-input-wrapper">
                            <input type="text" id="date-to-display" class="date-display" placeholder="YYYY-MM-DD" aria-label="End date" inputmode="numeric">
                            <input type="date" id="date-to" class="date-native" lang="en-US" tabindex="-1" aria-hidden="true">
                            <button type="button" class="date-picker-btn" aria-label="Open date picker" tabindex="-1">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label id="bbox-label">Bounding Box:</label>
                    <div class="bbox-inputs" role="group" aria-labelledby="bbox-label">
                        <div class="bbox-field">
                            <label for="bbox-west" class="visually-hidden">West longitude</label>
                            <input type="number" id="bbox-west" placeholder="West" step="0.001" aria-label="West longitude">
                            <label for="bbox-west-hem" class="visually-hidden">West hemisphere</label>
                            <select id="bbox-west-hem" title="Longitude hemisphere" aria-label="West hemisphere">
                                <option value="E" selected>E</option>
                                <option value="W">W</option>
                            </select>
                        </div>
                        <div class="bbox-field">
                            <label for="bbox-south" class="visually-hidden">South latitude</label>
                            <input type="number" id="bbox-south" placeholder="South" step="0.001" aria-label="South latitude">
                            <label for="bbox-south-hem" class="visually-hidden">South hemisphere</label>
                            <select id="bbox-south-hem" title="Latitude hemisphere" aria-label="South hemisphere">
                                <option value="N" selected>N</option>
                                <option value="S">S</option>
                            </select>
                        </div>
                        <div class="bbox-field">
                            <label for="bbox-east" class="visually-hidden">East longitude</label>
                            <input type="number" id="bbox-east" placeholder="East" step="0.001" aria-label="East longitude">
                            <label for="bbox-east-hem" class="visually-hidden">East hemisphere</label>
                            <select id="bbox-east-hem" title="Longitude hemisphere" aria-label="East hemisphere">
                                <option value="E" selected>E</option>
                                <option value="W">W</option>
                            </select>
                        </div>
                        <div class="bbox-field">
                            <label for="bbox-north" class="visually-hidden">North latitude</label>
                            <input type="number" id="bbox-north" placeholder="North" step="0.001" aria-label="North latitude">
                            <label for="bbox-north-hem" class="visually-hidden">North hemisphere</label>
                            <select id="bbox-north-hem" title="Latitude hemisphere" aria-label="North hemisphere">
                                <option value="N" selected>N</option>
                                <option value="S">S</option>
                            </select>
                        </div>
                    </div>
                    <button id="draw-bbox" class="secondary-btn" aria-label="Draw bounding box on map or display entered coordinates">Draw on Map</button>
                </div>

                <div class="form-group">
                    <label for="limit">Max Results:</label>
                    <input type="number" id="limit" value="10" min="1" max="100">
                </div>

                <button id="search-btn" class="primary-btn" aria-label="Apply search parameters and find STAC items">Apply Search</button>
            </aside>

            <!-- Center - Map View / 中间 - 地图视图 -->
            <main class="map-container">
                <div id="map"></div>
                <!-- Drawing Tools Toolbar / 绘制工具栏 -->
                <div class="map-toolbar drawing-tools" role="toolbar" aria-label="Drawing tools">
                    <button id="toggle-drawing-tools" class="tool-btn" title="Toggle Drawing Tools" aria-label="Toggle drawing tools" aria-expanded="true">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true" focusable="false">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </button>
                    <div class="drawing-tools-content" role="group" aria-label="Drawing options">
                        <button id="draw-polygon" class="tool-btn" title="Draw Polygon" aria-label="Draw polygon on map" aria-pressed="false">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
                                <polygon points="5 5 19 8 16 19 6 16" />
                            </svg>
                        </button>
                        <button id="draw-rectangle" class="tool-btn" title="Draw Rectangle" aria-label="Draw rectangle on map" aria-pressed="false">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
                                <rect x="4" y="6" width="16" height="12" rx="1" ry="1"></rect>
                            </svg>
                        </button>
                        <button id="clear-drawing" class="tool-btn" title="Clear Drawing" aria-label="Clear all drawings from map">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
                                <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <!-- Navigation Controls / 导航控件 -->
                <div class="map-controls" role="group" aria-label="Map navigation">
                    <div class="nav-group">
                        <button id="zoom-in" class="nav-btn" title="Zoom In" aria-label="Zoom in">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true" focusable="false">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                        <hr class="nav-divider" aria-hidden="true">
                        <button id="zoom-out" class="nav-btn" title="Zoom Out" aria-label="Zoom out">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true" focusable="false">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="nav-group">
                        <button id="reset-view" class="nav-btn" title="Home" aria-label="Reset map view to home">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true" focusable="false">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Basemap Switcher / 底图切换器 -->
                <div class="map-basemap">
                    <label for="basemap-select" class="visually-hidden">Select basemap</label>
                    <select id="basemap-select" title="Basemap selection" aria-label="Select basemap">
                        <option value="osm">OpenStreetMap</option>
                        <option value="esri_img">Esri World Imagery (EN labels)</option>
                        <option value="google_sat">Google Satellite</option>
                        <option value="google_hyb">Google Hybrid</option>
                        <option value="google_road">Google Road</option>
                    </select>
                </div>
            </main>

            <!-- Right Panel - Results / 右侧面板 - 结果 -->
            <aside class="results-panel" aria-label="Search results">
                <h2>Search Results</h2>
                <div id="results-count" aria-live="polite"></div>
                <div id="results-list" role="list" aria-label="Search result items"></div>
            </aside>
        </div>

        <!-- Item Detail Modal / 项目详情弹窗 -->
        <div id="item-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="item-modal-title">
            <div class="modal-content">
                <button class="close" type="button" aria-label="Close dialog">&times;</button>
                <h2 id="item-modal-title">Item Details</h2>
                <div id="item-details"></div>
            </div>
        </div>

        <!-- Collection Picker Modal / 集合选择器弹窗 -->
        <div id="collection-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="collection-modal-title">
            <div class="modal-content">
                <button class="close" type="button" aria-label="Close dialog">&times;</button>
                <h2 id="collection-modal-title">Select Collection</h2>
                <div id="collection-list" class="collection-list">
                    <div class="collection-search-row">
                        <label for="collection-search" class="visually-hidden">Search collections</label>
                        <input id="collection-search" type="text" placeholder="Search collections by ID, title, keywords" />
                    </div>
                    <div id="collection-grid" class="collection-grid" role="list" aria-label="Collection list"></div>
                    <div id="collection-pagination" class="collection-pagination"></div>
                </div>
                <div id="collection-detail" class="collection-detail hidden"></div>
            </div>
        </div>
    </div>

    <!-- Runtime config (injected by CI, not bundled by Vite) -->
    <script src="./runtime-config.js" onerror=""></script>
    <script type="module" src="./src/main.js"></script>
</body>
</html>
